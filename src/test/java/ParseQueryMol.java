/*
 * NCATS-MOLWITCH-CDK
 *
 * Copyright (c) 2020.
 *
 * This work is free software; you can redistribute it and/or modify it under the terms of the
 * GNU Lesser General Public License as published by the Free Software Foundation;
 * either version 2.1 of the License, or (at your option) any later version.
 *
 * This work is distributed in the hope that it will be useful, but without any warranty;
 * without even the implied warranty of merchantability or fitness for a particular purpose.
 * See the GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License along with this library;
 *  if not, write to:
 *
 *  the Free Software Foundation, Inc.
 *  59 Temple Place, Suite 330
 *  Boston, MA 02111-1307 USA
 */

import static org.junit.Assert.*;

import java.io.IOException;
import java.util.BitSet;
import java.util.Optional;

import org.junit.Test;

import gov.nih.ncats.molwitch.Chemical;
import gov.nih.ncats.molwitch.fingerprint.Fingerprint;
import gov.nih.ncats.molwitch.fingerprint.Fingerprinter;
import gov.nih.ncats.molwitch.fingerprint.Fingerprinters;
import gov.nih.ncats.molwitch.fingerprint.Fingerprinters.FingerprintSpecification;
import gov.nih.ncats.molwitch.search.MolSearcherFactory;

public class ParseQueryMol {

    @Test
    public void atomListsAndQueryBondFingerprintsWork() throws IOException {
    	  String mol= "\n" + 
          		"   JSDraw209242017322D\n" + 
          		"\n" + 
          		" 22 22  0  0  0  0            999 V2000\n" + 
          		"   25.4825   -7.6960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   24.1315   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   24.1315   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   26.8335   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   26.8335   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   25.4825   -4.5760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   28.1845   -4.5760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   28.1845   -3.0160    0.0000 L   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   29.5355   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   22.7805   -4.5760    0.0000 L   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   25.4825   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   26.8335  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   24.1315  -10.0360    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   28.1845   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   29.5355  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   30.8865   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   32.2375  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   33.5885   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   32.2375  -11.5960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   33.5885   -7.6960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   34.9395   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   33.5885  -12.3760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"  1  2  2  0  0  0  0\n" + 
          		"  2  3  1  0  0  0  0\n" + 
          		"  1  4  1  0  0  0  0\n" + 
          		"  4  5  2  0  0  0  0\n" + 
          		"  5  6  1  0  0  0  0\n" + 
          		"  6  3  2  0  0  0  0\n" + 
          		"  5  7  1  0  0  0  0\n" + 
          		"  7  8  1  0  0  0  0\n" + 
          		"  7  9  6  0  0  0  0\n" + 
          		"  3 10  1  0  0  0  0\n" + 
          		"  1 11  1  0  0  0  0\n" + 
          		" 11 12  1  0  0  0  0\n" + 
          		" 11 13  8  0  0  0  0\n" + 
          		" 12 14  1  0  0  0  0\n" + 
          		" 14 15  1  0  0  0  0\n" + 
          		" 15 16  1  0  0  0  0\n" + 
          		" 16 17  1  0  0  0  0\n" + 
          		" 17 18  1  0  0  0  0\n" + 
          		" 17 19  1  0  0  0  0\n" + 
          		" 18 20  1  0  0  0  0\n" + 
          		" 20 21  4  0  0  0  0\n" + 
          		" 19 22  7  0  0  0  0\n" + 
          		"M  ALS   8  2 F O   N   \n" + 
          		"M  ALS  10  1 T C   \n" + 
          		"M  END";
          
        
        Chemical c = Chemical.parseMol(mol);

        Fingerprinter fingerPrinterSub =  Fingerprinters.getFingerprinter(FingerprintSpecification.PATH_BASED.create().setLength(512));
        
        Fingerprint fp=fingerPrinterSub.computeFingerprint(c);
        
        
        String mm="\n" + 
        		"   JSDraw209242017082D\n" + 
        		"\n" + 
        		" 27 28  0  0  0  0            999 V2000\n" + 
        		"   25.4825   -7.6960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   24.1315   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   24.1315   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   26.8335   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   26.8335   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   25.4825   -4.5760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   28.1845   -4.5760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   28.1845   -3.0160    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   29.5355   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   22.7805   -4.5760    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   25.4825   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   26.8335  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   24.1315  -10.0360    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   28.1845   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   29.5355  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   30.8865   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   32.2375  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   33.5885   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   32.2375  -11.5960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   33.5885   -7.6960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   34.9395   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   33.5885  -12.3760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   26.8335  -11.5960    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   34.9395   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   32.2375   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   32.2375   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   33.5885   -4.5760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"  1  2  2  0  0  0  0\n" + 
        		"  2  3  1  0  0  0  0\n" + 
        		"  1  4  1  0  0  0  0\n" + 
        		"  4  5  2  0  0  0  0\n" + 
        		"  5  6  1  0  0  0  0\n" + 
        		"  6  3  2  0  0  0  0\n" + 
        		"  5  7  1  0  0  0  0\n" + 
        		"  7  8  1  0  0  0  0\n" + 
        		"  7  9  1  0  0  0  0\n" + 
        		"  3 10  1  0  0  0  0\n" + 
        		"  1 11  1  0  0  0  0\n" + 
        		" 11 12  1  0  0  0  0\n" + 
        		" 11 13  1  0  0  0  0\n" + 
        		" 12 14  1  0  0  0  0\n" + 
        		" 14 15  1  0  0  0  0\n" + 
        		" 15 16  1  0  0  0  0\n" + 
        		" 16 17  1  0  0  0  0\n" + 
        		" 17 18  1  0  0  0  0\n" + 
        		" 17 19  1  0  0  0  0\n" + 
        		" 18 20  1  0  0  0  0\n" + 
        		" 20 21  4  0  0  0  0\n" + 
        		" 19 22  2  0  0  0  0\n" + 
        		" 12 23  1  0  0  0  0\n" + 
        		" 21 24  4  0  0  0  0\n" + 
        		" 20 25  4  0  0  0  0\n" + 
        		" 25 26  4  0  0  0  0\n" + 
        		" 26 27  4  0  0  0  0\n" + 
        		" 27 24  4  0  0  0  0\n" + 
        		"M  END";
        Chemical c2 = Chemical.parseMol(mm);

        Fingerprint fp2=fingerPrinterSub.computeFingerprint(c2);
        
        BitSet bsTemp = BitSet.valueOf(fp.toBitSet().toLongArray());
        bsTemp.and(fp2.toBitSet());

        assertEquals(fp.populationCount(), bsTemp.cardinality());
        
    }
    
    @Test
    public void atomListsAndQueryBondSmartsExportWorks() throws IOException {
    	  String mol= "\n" + 
          		"   JSDraw209242017322D\n" + 
          		"\n" + 
          		" 22 22  0  0  0  0            999 V2000\n" + 
          		"   25.4825   -7.6960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   24.1315   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   24.1315   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   26.8335   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   26.8335   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   25.4825   -4.5760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   28.1845   -4.5760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   28.1845   -3.0160    0.0000 L   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   29.5355   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   22.7805   -4.5760    0.0000 L   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   25.4825   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   26.8335  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   24.1315  -10.0360    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   28.1845   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   29.5355  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   30.8865   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   32.2375  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   33.5885   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   32.2375  -11.5960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   33.5885   -7.6960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   34.9395   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"   33.5885  -12.3760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
          		"  1  2  2  0  0  0  0\n" + 
          		"  2  3  1  0  0  0  0\n" + 
          		"  1  4  1  0  0  0  0\n" + 
          		"  4  5  2  0  0  0  0\n" + 
          		"  5  6  1  0  0  0  0\n" + 
          		"  6  3  2  0  0  0  0\n" + 
          		"  5  7  1  0  0  0  0\n" + 
          		"  7  8  1  0  0  0  0\n" + 
          		"  7  9  6  0  0  0  0\n" + 
          		"  3 10  1  0  0  0  0\n" + 
          		"  1 11  1  0  0  0  0\n" + 
          		" 11 12  1  0  0  0  0\n" + 
          		" 11 13  8  0  0  0  0\n" + 
          		" 12 14  1  0  0  0  0\n" + 
          		" 14 15  1  0  0  0  0\n" + 
          		" 15 16  1  0  0  0  0\n" + 
          		" 16 17  1  0  0  0  0\n" + 
          		" 17 18  1  0  0  0  0\n" + 
          		" 17 19  1  0  0  0  0\n" + 
          		" 18 20  1  0  0  0  0\n" + 
          		" 20 21  4  0  0  0  0\n" + 
          		" 19 22  7  0  0  0  0\n" + 
          		"M  ALS   8  2 F O   N   \n" + 
          		"M  ALS  10  1 T C   \n" + 
          		"M  END";
          
        
        Chemical c = Chemical.parseMol(mol);
        String smarts=c.toSmarts();
        
        System.out.println(smarts);
        
        
        String mm="\n" + 
        		"   JSDraw209242017082D\n" + 
        		"\n" + 
        		" 27 28  0  0  0  0            999 V2000\n" + 
        		"   25.4825   -7.6960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   24.1315   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   24.1315   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   26.8335   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   26.8335   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   25.4825   -4.5760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   28.1845   -4.5760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   28.1845   -3.0160    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   29.5355   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   22.7805   -4.5760    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   25.4825   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   26.8335  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   24.1315  -10.0360    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   28.1845   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   29.5355  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   30.8865   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   32.2375  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   33.5885   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   32.2375  -11.5960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   33.5885   -7.6960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   34.9395   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   33.5885  -12.3760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   26.8335  -11.5960    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   34.9395   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   32.2375   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   32.2375   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   33.5885   -4.5760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"  1  2  2  0  0  0  0\n" + 
        		"  2  3  1  0  0  0  0\n" + 
        		"  1  4  1  0  0  0  0\n" + 
        		"  4  5  2  0  0  0  0\n" + 
        		"  5  6  1  0  0  0  0\n" + 
        		"  6  3  2  0  0  0  0\n" + 
        		"  5  7  1  0  0  0  0\n" + 
        		"  7  8  1  0  0  0  0\n" + 
        		"  7  9  1  0  0  0  0\n" + 
        		"  3 10  1  0  0  0  0\n" + 
        		"  1 11  1  0  0  0  0\n" + 
        		" 11 12  1  0  0  0  0\n" + 
        		" 11 13  1  0  0  0  0\n" + 
        		" 12 14  1  0  0  0  0\n" + 
        		" 14 15  1  0  0  0  0\n" + 
        		" 15 16  1  0  0  0  0\n" + 
        		" 16 17  1  0  0  0  0\n" + 
        		" 17 18  1  0  0  0  0\n" + 
        		" 17 19  1  0  0  0  0\n" + 
        		" 18 20  1  0  0  0  0\n" + 
        		" 20 21  4  0  0  0  0\n" + 
        		" 19 22  2  0  0  0  0\n" + 
        		" 12 23  1  0  0  0  0\n" + 
        		" 21 24  4  0  0  0  0\n" + 
        		" 20 25  4  0  0  0  0\n" + 
        		" 25 26  4  0  0  0  0\n" + 
        		" 26 27  4  0  0  0  0\n" + 
        		" 27 24  4  0  0  0  0\n" + 
        		"M  END";
        Chemical c2 = Chemical.parseMol(mm);
        System.out.println(c2.toSmarts());

        
    }
    
    @Test
    public void atomListsAndQueryBondStructureSearchWork() throws IOException {
        String mol= "\n" + 
        		"   JSDraw209242017322D\n" + 
        		"\n" + 
        		" 22 22  0  0  0  0            999 V2000\n" + 
        		"   25.4825   -7.6960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   24.1315   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   24.1315   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   26.8335   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   26.8335   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   25.4825   -4.5760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   28.1845   -4.5760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   28.1845   -3.0160    0.0000 L   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   29.5355   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   22.7805   -4.5760    0.0000 L   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   25.4825   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   26.8335  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   24.1315  -10.0360    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   28.1845   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   29.5355  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   30.8865   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   32.2375  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   33.5885   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   32.2375  -11.5960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   33.5885   -7.6960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   34.9395   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   33.5885  -12.3760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"  1  2  2  0  0  0  0\n" + 
        		"  2  3  1  0  0  0  0\n" + 
        		"  1  4  1  0  0  0  0\n" + 
        		"  4  5  2  0  0  0  0\n" + 
        		"  5  6  1  0  0  0  0\n" + 
        		"  6  3  2  0  0  0  0\n" + 
        		"  5  7  1  0  0  0  0\n" + 
        		"  7  8  1  0  0  0  0\n" + 
        		"  7  9  6  0  0  0  0\n" + 
        		"  3 10  1  0  0  0  0\n" + 
        		"  1 11  1  0  0  0  0\n" + 
        		" 11 12  1  0  0  0  0\n" + 
        		" 11 13  8  0  0  0  0\n" + 
        		" 12 14  1  0  0  0  0\n" + 
        		" 14 15  1  0  0  0  0\n" + 
        		" 15 16  1  0  0  0  0\n" + 
        		" 16 17  1  0  0  0  0\n" + 
        		" 17 18  1  0  0  0  0\n" + 
        		" 17 19  1  0  0  0  0\n" + 
        		" 18 20  1  0  0  0  0\n" + 
        		" 20 21  4  0  0  0  0\n" + 
        		" 19 22  7  0  0  0  0\n" + 
        		"M  ALS   8  2 F O   N   \n" + 
        		"M  ALS  10  1 T C   \n" + 
        		"M  END";
        
        Chemical c = Chemical.parseMol(mol);
        
        String mm="\n" + 
        		"   JSDraw209242017082D\n" + 
        		"\n" + 
        		" 27 28  0  0  0  0            999 V2000\n" + 
        		"   25.4825   -7.6960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   24.1315   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   24.1315   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   26.8335   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   26.8335   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   25.4825   -4.5760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   28.1845   -4.5760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   28.1845   -3.0160    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   29.5355   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   22.7805   -4.5760    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   25.4825   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   26.8335  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   24.1315  -10.0360    0.0000 O   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   28.1845   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   29.5355  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   30.8865   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   32.2375  -10.0360    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   33.5885   -9.2560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   32.2375  -11.5960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   33.5885   -7.6960    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   34.9395   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   33.5885  -12.3760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   26.8335  -11.5960    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   34.9395   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   32.2375   -6.9160    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   32.2375   -5.3560    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"   33.5885   -4.5760    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0\n" + 
        		"  1  2  2  0  0  0  0\n" + 
        		"  2  3  1  0  0  0  0\n" + 
        		"  1  4  1  0  0  0  0\n" + 
        		"  4  5  2  0  0  0  0\n" + 
        		"  5  6  1  0  0  0  0\n" + 
        		"  6  3  2  0  0  0  0\n" + 
        		"  5  7  1  0  0  0  0\n" + 
        		"  7  8  1  0  0  0  0\n" + 
        		"  7  9  1  0  0  0  0\n" + 
        		"  3 10  1  0  0  0  0\n" + 
        		"  1 11  1  0  0  0  0\n" + 
        		" 11 12  1  0  0  0  0\n" + 
        		" 11 13  1  0  0  0  0\n" + 
        		" 12 14  1  0  0  0  0\n" + 
        		" 14 15  1  0  0  0  0\n" + 
        		" 15 16  1  0  0  0  0\n" + 
        		" 16 17  1  0  0  0  0\n" + 
        		" 17 18  1  0  0  0  0\n" + 
        		" 17 19  1  0  0  0  0\n" + 
        		" 18 20  1  0  0  0  0\n" + 
        		" 20 21  4  0  0  0  0\n" + 
        		" 19 22  2  0  0  0  0\n" + 
        		" 12 23  1  0  0  0  0\n" + 
        		" 21 24  4  0  0  0  0\n" + 
        		" 20 25  4  0  0  0  0\n" + 
        		" 25 26  4  0  0  0  0\n" + 
        		" 26 27  4  0  0  0  0\n" + 
        		" 27 24  4  0  0  0  0\n" + 
        		"M  END";
        
        System.out.println(mm);
        
        Chemical c2 = Chemical.parseMol(mm);
        
        Optional<int[]> hit = MolSearcherFactory.create(c).search(c2);
		

		assertEquals("true",""+hit.isPresent());
        
        
    }
}
